<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ù…Ù†ØµØ© Ø£Ø¹Ù…Ø§Ù„ ÙˆÙ…Ø¨Ø§Ø¯Ø±Ø§Øª Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„ÙŠØ¹Ù‚ÙˆØ¨ÙŠ Ø¨Ø§Ù„Ø®Ø¨Ø±</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --heroW:2048; --heroH:478; /* Ù†Ø³Ø¨Ø© Ø§Ù„Ù‡ÙŠØ¯Ø± Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ´ÙˆÙ‘Ù‡ */
  --ink:#0e3134; --muted:#556872; --line:#e1ecec;
  --paper:#fff; --bg:#f3f7f7; --accent:#0a8a7a;
  --shine:linear-gradient(120deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.35) 45%, rgba(255,255,255,0) 60%);
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"Tajawal",system-ui,sans-serif}
a{color:inherit;text-decoration:none}
.container{max-width:calc(var(--heroW) * 1px);margin-inline:auto;padding:0 12px 14px}
.container::before{content:"";display:block;height:10px;margin:10px 0 8px;background:linear-gradient(90deg,#dff5f1,#f0fbff,#dff5f1);border-radius:10px;filter:brightness(1.04) saturate(1.05)}
.hero{width:100%;aspect-ratio:var(--heroW)/var(--heroH);position:relative;overflow:hidden;border-radius:12px;box-shadow:0 14px 28px rgba(0,0,0,.06)}
.hero img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block;user-select:none;-webkit-user-drag:none}
.section{background:var(--paper);border:1px solid var(--line);border-radius:18px;padding:16px;box-shadow:0 12px 28px rgba(0,0,0,.04);position:relative;overflow:hidden}
.section::after{content:"";position:absolute;inset:-40% -60%;background:radial-gradient(600px 120px at 0% 0%, rgba(255,255,255,.7), transparent 60%);transform:rotate(3deg);pointer-events:none;mix-blend-mode:soft-light}
.section h2{margin:0 0 10px;font-size:clamp(18px,2.1vw,21px);color:#0a4a46;display:flex;align-items:center;gap:10px}
.row-plat-init{display:grid;gap:14px;margin:14px 0;grid-template-columns:2fr 1fr}
@media (max-width:1100px){.row-plat-init{grid-template-columns:1fr}}
.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
.chip{border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:13px;background:#f5fbfb;color:#0a5c58;cursor:pointer}
.chip.active{background:linear-gradient(90deg,#e8fbf5,#e9f6ff);border-color:#cfeae6}
.search{position:relative;flex:1;min-width:220px}
.search input{width:100%;border:1px solid var(--line);background:#fbfefe;padding:10px 12px;border-radius:12px;font-size:13.5px}
.cards{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
@media (max-width:1100px){.cards{grid-template-columns:repeat(2,1fr)}}
@media (max-width:640px){.cards{grid-template-columns:1fr}}
.card{background:linear-gradient(180deg,#ffffff,#f8fcfc);border:1px solid var(--line);border-radius:14px;padding:14px;display:grid;grid-template-columns:1fr auto;gap:8px;align-items:start;transition:transform .15s,box-shadow .2s,background .3s;position:relative;overflow:hidden}
.card::before{content:"";position:absolute;top:-120%;inset-inline:-40%;height:220%;background:var(--shine);transform:translateX(-60%) rotate(10deg);transition:transform .6s;pointer-events:none}
.card:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(0,0,0,.07)}
.card:hover::before{transform:translateX(120%) rotate(10deg)}
.card .title{font-weight:800;color:#064a45;font-size:15px}
.card .desc{grid-column:1 / -1;font-size:13.5px;color:var(--muted)}
.badges{display:flex;gap:6px;flex-wrap:wrap}
.badge{font-size:11.5px;padding:3px 8px;border-radius:999px;border:1px solid var(--line);background:#f5fbfb;color:#0a5a56}
.actions{display:flex;gap:8px}
.linkcard{grid-template-columns:1fr;cursor:pointer;position:relative}
.linkcard .desc{grid-column:auto}
.linkcard .actions{display:none}
.btn{border:1px solid var(--line);background:#fff;padding:7px 10px;border-radius:11px;font-weight:700;font-size:12.5px;display:inline-flex;align-items:center;gap:7px}
.btn:hover{background:#f2faf8}
.btn.open{color:#0a4a46}
.btn.download{color:#0a6e5f;border-color:#cfeadf}
.columns{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:12px 0}
@media (max-width:1200px){.columns{grid-template-columns:repeat(2,1fr)}}
@media (max-width:700px){.columns{grid-template-columns:1fr}}
.list{display:grid;grid-template-columns:1fr;gap:12px}
.modal-back{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;place-items:center;z-index:50;padding:12px}
.modal{width:min(880px,96vw);background:#fff;border-radius:14px;border:1px solid var(--line);box-shadow:0 20px 60px rgba(0,0,0,.25)}
.modal header{padding:12px 14px;border-bottom:1px solid var(--line);display:flex;align-items:center;gap:8px}
.modal header h3{margin:0;font-size:16px}
.modal .body{padding:12px 14px;max-height:min(70vh,720px);overflow:auto}
.modal .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.modal label{font-size:12.5px;color:#335}
.modal input[type=text],.modal textarea,.modal select{width:100%;border:1px solid var(--line);border-radius:10px;padding:9px 11px;font-family:inherit;font-size:13.5px;background:#fbfefe}
.modal textarea{min-height:90px;resize:vertical}
.modal .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:10px}
.modal footer{padding:10px 14px;border-top:1px solid var(--line);display:flex;justify-content:space-between;gap:10px}
.kbd{background:#eef4f3;border:1px solid #d7e7e4;padding:0 6px;border-radius:6px;font-size:12px}
.footer{background:linear-gradient(90deg,#0e6462,#2f7f79);color:#e8fffb;text-align:center;padding:9px 12px;border-radius:14px;margin:16px 0;font-size:12.5px}
.footer b{color:#fff}
#countP{display:none}
</style>
</head>
<body>

<div class="container">
  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <header class="hero" aria-label="Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù†ØµØ©">
    <img src="logo.png" alt="Ù…Ù†ØµØ© Ø£Ø¹Ù…Ø§Ù„ ÙˆÙ…Ø¨Ø§Ø¯Ø±Ø§Øª Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„ÙŠØ¹Ù‚ÙˆØ¨ÙŠ Ø¨Ø§Ù„Ø®Ø¨Ø±">
  </header>

  <!-- ØµÙ: Ø§Ù„Ù…Ù†ØµØ§Øª + Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª -->
  <div class="row-plat-init">
    <section class="section" id="platforms">
      <h2>
        Ù…Ù†ØµØ§Øª ÙˆÙ…ÙˆØ§Ù‚Ø¹ ØªØ¹Ù„ÙŠÙ…ÙŠØ©
        <span id="countP"></span>
        <button id="btnEditPlatforms" class="btn" style="margin-inline-start:auto">âš™ï¸ ØªØ­Ø±ÙŠØ±</button>
      </h2>
      <div class="toolbar">
        <button class="chip active" data-filter="all">Ø§Ù„ÙƒÙ„</button>
        <button class="chip" data-filter="ÙˆØ²Ø§Ø±Ø©">ÙˆØ²Ø§Ø±Ø©</button>
        <button class="chip" data-filter="ØªØ¹Ù„Ù…">ØªØ¹Ù„Ù…</button>
        <button class="chip" data-filter="Ø¯Ø®ÙˆÙ„">Ø¯Ø®ÙˆÙ„</button>
        <div class="search"><input id="platformSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØµØ© Ø£Ùˆ Ø§Ù„ÙˆØµÙâ€¦"></div>
      </div>
      <div class="cards" id="platformGrid"></div>
    </section>

    <section class="section" id="initiatives">
      <h2>
        Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª
        <button id="btnEditInit" class="btn" style="margin-inline-start:auto">âš™ï¸ ØªØ­Ø±ÙŠØ±</button>
      </h2>
      <div class="list" id="initList"></div>
    </section>
  </div>

  <!-- Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© -->
  <section class="section" id="docs">
    <h2>
      Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø©
      <button id="btnManageDocs" class="btn" style="margin-inline-start:auto">âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯Ù„Ù‘Ø©</button>
    </h2>
    <div class="columns" id="docsCols"></div>
  </section>

  <div class="footer"><b>ØªÙ†ÙÙŠØ° ÙˆØªØ¬Ù…ÙŠØ¹:</b> ÙÙ‡Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© -->
<div class="modal-back" id="docsModalBack" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="docsModalTitle">
    <header><h3 id="docsModalTitle">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø©</h3><span class="kbd">PIN</span> Ù¡Ù¤Ù¤Ù§</header>
    <div class="body">
      <div class="row">
        <button class="btn" id="addDoc">â• Ø¥Ø¶Ø§ÙØ© Ø¯Ù„ÙŠÙ„</button>
        <button class="btn" id="resetDocs">â™»ï¸ ØªØµÙÙŠØ± (Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¨Ø¯Ø¦ÙŠ)</button>
      </div>
      <div id="docsListAdmin" style="margin-top:10px"></div>
      <hr>
      <div class="grid2">
        <div><label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input type="text" id="docTitle"></div>
        <div><label>Ø§Ù„Ù†ÙˆØ¹</label>
          <select id="docKind">
            <option>Ø¯Ù„ÙŠÙ„</option><option>Ù„Ø§Ø¦Ø­Ø©</option><option>Ù‚ÙˆØ§Ø¹Ø¯</option><option>Ø¢Ù„ÙŠØ©</option><option>Ù†Ù…ÙˆØ°Ø¬</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div style="flex:1"><label>Ø§Ù„Ø±Ø§Ø¨Ø· (Ø¥Ù† ÙˆØ¬Ø¯)</label><input type="text" id="docUrl" placeholder="https://â€¦"></div>
        <div><label>Ø£Ùˆ Ø§Ø±ÙØ¹ PDF</label><br><input type="file" id="docFile" accept="application/pdf"></div>
      </div>
      <div style="margin-top:8px"><label>ÙˆØµÙ Ù…Ø®ØªØµØ±</label><textarea id="docDesc" placeholder="Ù…Ù„Ø®Øµ Ù…ÙˆØ¬Ø² Ù„Ù„Ø¯Ù„ÙŠÙ„â€¦"></textarea></div>
    </div>
    <footer>
      <div class="row">
        <button class="btn" id="saveDoc">ğŸ’¾ Ø­ÙØ¸/ØªØ­Ø¯ÙŠØ«</button>
        <button class="btn" id="cancelDoc">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="row"><span style="font-size:12px;color:#6b7">Ù…Ù„ÙØ§Øª PDF ØªÙØ­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§ (Data URL).</span></div>
    </footer>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…Ù†ØµØ§Øª -->
<div class="modal-back" id="platModalBack" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="platModalTitle">
    <header><h3 id="platModalTitle">ØªØ­Ø±ÙŠØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØµØ§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹</h3><span class="kbd">PIN</span> Ù¡Ù¤Ù¤Ù§</header>
    <div class="body">
      <p style="margin:4px 0 8px;color:#456;font-size:13px">ØµÙŠØºØ© JSON: <b>name</b>, <b>desc</b>, <b>url</b>, <b>tags</b>.</p>
      <textarea id="platEditor" style="width:100%;min-height:340px;border:1px solid var(--line);border-radius:10px;padding:10px;font-family:ui-monospace,mono;font-size:13px"></textarea>
    </div>
    <footer>
      <div class="row">
        <button class="btn" id="savePlat">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="btn" id="resetPlat">â™»ï¸ ØªØµÙÙŠØ±</button>
        <button class="btn" id="cancelPlat">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <span style="font-size:12.5px;color:#6b7">ÙŠÙØ­ÙØ¸ ØªØ­Øª Ø§Ù„Ù…ÙØªØ§Ø­ platforms_custom_v1</span>
    </footer>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª -->
<div class="modal-back" id="initModalBack" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="initModalTitle">
    <header><h3 id="initModalTitle">ØªØ­Ø±ÙŠØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª</h3><span class="kbd">PIN</span> Ù¡Ù¤Ù¤Ù§</header>
    <div class="body">
      <p style="margin:4px 0 8px;color:#456;font-size:13px">ØµÙŠØºØ© JSON: <b>title</b>, <b>url</b>, <b>note</b>.</p>
      <textarea id="initEditor" style="width:100%;min-height:340px;border:1px solid var(--line);border-radius:10px;padding:10px;font-family:ui-monospace,mono;font-size:13px"></textarea>
    </div>
    <footer>
      <div class="row">
        <button class="btn" id="saveInit">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="btn" id="resetInit">â™»ï¸ ØªØµÙÙŠØ±</button>
        <button class="btn" id="cancelInit">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <span style="font-size:12.5px;color:#6b7">ÙŠÙØ­ÙØ¸ ØªØ­Øª Ø§Ù„Ù…ÙØªØ§Ø­ initiatives_custom_v1</span>
    </footer>
  </div>
</div>

<script>
/* ================= Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ®Ø²ÙŠÙ† ================= */
const ADMIN_PIN = "1447";
const KEY_DOCS = "docs_custom_v1";
const KEY_PLAT = "platforms_custom_v1";
const KEY_INIT = "initiatives_custom_v1";

/* ================= Ø§Ù„Ù…Ù†ØµØ§Øª (Ø«Ø§Ø¨ØªØ© ÙƒÙ…Ø§ Ø¢Ø®Ø± Ù†Ø³Ø®Ø©) ================= */
const PLATFORMS_DEFAULT = [
  {name:"Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…ÙˆØ­Ù‘Ø¯ (IAM)", desc:"Ù†Ø¸Ø§Ù… Ø§Ù„Ù†ÙØ§Ø° Ø§Ù„Ù…ÙˆØ­Ù‘Ø¯ Ù„Ø¨ÙˆØ§Ø¨Ø§Øª ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…", url:"https://iam.moe.gov.sa/", tags:["ÙˆØ²Ø§Ø±Ø©","Ø¯Ø®ÙˆÙ„"]},
  {name:"Ù…Ø¯Ø±Ø³ØªÙŠ", desc:"Ù…Ù†ØµØ© Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", url:"https://schools.madrasati.sa/", tags:["ØªØ¹Ù„Ù…"]},
  {name:"Ù†ÙˆØ±", desc:"Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨", url:"https://noor.moe.gov.sa/Noor/login.aspx", tags:["ÙˆØ²Ø§Ø±Ø©","Ø¯Ø®ÙˆÙ„"]},
  {name:"Ù‚Ù†Ø§Ø© Ø¹ÙŠÙ†", desc:"Ø§Ù„Ø¨Ø« Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ ÙˆÙ…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ", url:"http://www.ientv.edu.sa/", tags:["ØªØ¹Ù„Ù…"]},
  {name:"Ø­Ø¶ÙˆØ±ÙŠ", desc:"Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù", url:"https://hather-ui.moe.gov.sa/dashboard", tags:["ÙˆØ²Ø§Ø±Ø©","Ø¯Ø®ÙˆÙ„"]},
  {name:"ÙØ§Ø±Ø³", desc:"Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© Ù„Ù…Ù†Ø³ÙˆØ¨ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…", url:"https://sshr.moe.gov.sa/", tags:["ÙˆØ²Ø§Ø±Ø©","Ø¯Ø®ÙˆÙ„"]},
  {name:"Microsoft Forms", desc:"Ù†Ù…Ø§Ø°Ø¬ ÙˆØ§Ø³ØªØ¨Ø§Ù†Ø§Øª ÙˆØ£Ù†Ø´Ø·Ø© ØªÙ‚ÙŠÙŠÙ…ÙŠØ©", url:"https://forms.office.com/", tags:["ØªØ¹Ù„Ù…"]},
  {name:"Microsoft Teams", desc:"Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª ÙˆØ¯Ø±ÙˆØ³ Ø§ÙØªØ±Ø§Ø¶ÙŠØ©", url:"https://teams.microsoft.com/", tags:["ØªØ¹Ù„Ù…","Ø¯Ø®ÙˆÙ„"]},
  {name:"ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ø¹Ù„Ù‰ Ù…Ù†ØµØ© X", url:"https://x.com/moe_gov_sa", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"Ø§Ù„Ù…ØªØ­Ø¯Ø« Ø§Ù„Ø±Ø³Ù…ÙŠ â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„Ù…ØªØ­Ø¯Ø« Ø¨Ø§Ø³Ù… ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…", url:"https://x.com/spokesp_moe", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"Ù‡ÙŠØ¦Ø© ØªÙ‚ÙˆÙŠÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù‡ÙŠØ¦Ø© ØªÙ‚ÙˆÙŠÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨", url:"https://x.com/EtecKsa", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø´Ø±Ù‚ÙŠØ© â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø´Ø±Ù‚ÙŠØ©", url:"https://x.com/edueast", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø±ÙŠØ§Ø¶ â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø±ÙŠØ§Ø¶", url:"https://x.com/riyadhedu", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"ØªØ¹Ù„ÙŠÙ… Ù…ÙƒØ© â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ù…ÙƒØ©", url:"https://x.com/MakkahEdu", tags:["ÙˆØ²Ø§Ø±Ø©"]},
  {name:"ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù‚ØµÙŠÙ… â€” X", desc:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù‚ØµÙŠÙ…", url:"https://x.com/QassimEdu", tags:["ÙˆØ²Ø§Ø±Ø©"]}
];

/* ================= Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© (Ø±ÙˆØ§Ø¨Ø· Ù…ÙØµØ­Ù‘Ø­Ø©) ================= */
const DOCS_DEFAULT = [
  {title:"Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ù„Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1E604s0Wni9ht-UnfaB4ywlN55YyjW9Wj/view?usp=sharing",
   desc:"Ù…Ø±Ø¬Ø¹ ÙŠÙˆØ¶Ù‘Ø­ Ù…Ù‡Ø§Ù… ÙˆØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆÙ‡ÙŠÙƒÙ„Ù‡Ø§ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ."},

  {title:"Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¦ÙŠ Ù„Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/18rVycmGYJ3vNrUq2hsAbZiDGv9WaZULR/view?usp=sharing",
   desc:"Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©."},

  {title:"Ù„Ø§Ø¦Ø­Ø© ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø·Ø§Ù„Ø¨ 2025Ù…", kind:"Ù„Ø§Ø¦Ø­Ø©",
   url:"https://drive.google.com/file/d/1jMcFdltw6SomgRAGyFQFOecvJOqF4m8-/view?usp=sharing",
   desc:"Ø£Ø³Ø§Ù„ÙŠØ¨ ÙˆØ£Ø¯ÙˆØ§Øª ÙˆØ¶ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù„Ø±ÙØ¹ Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªØ¹Ù„Ù‘Ù…."},

  {title:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ© Ù„Ù„Ø§Ø¦Ø­Ø© ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø·Ø§Ù„Ø¨ 2025Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1L5GiafAgPY0vBSQdea_obk9vKcE-t7JR/view",
   desc:"Ø¢Ù„ÙŠØ§Øª ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©."},

  {title:"Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„ÙˆÙƒ ÙˆØ§Ù„Ù…ÙˆØ§Ø¸Ø¨Ø© 1447Ù‡Ù€", kind:"Ù‚ÙˆØ§Ø¹Ø¯",
   url:"https://drive.google.com/file/d/1RYIYPFlAcT9Ya-RnPw3bnpQASVQIz0FX/view",
   desc:"Ø­Ù‚ÙˆÙ‚ ÙˆÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©."},

  {title:"Ø¢Ù„ÙŠØ© ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ 1447Ù‡Ù€", kind:"Ø¢Ù„ÙŠØ©",
   url:"https://drive.google.com/file/d/1ak9uHKDbi8cPecgYzV8_cIqv2-NlmOR_/view",
   desc:"ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ ÙˆÙÙ‚ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©."},

  {title:"Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ±Ø´Ø§Ø¯ÙŠ Ù„Ù…Ø´Ø±Ù Ø¯Ø¹Ù… Ø§Ù„ØªÙ…ÙŠØ²", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/17l_qlhdWdUBRWEbDcFKT0iCkUh2gifu4/view?usp=sharing",
   desc:"ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ù…Ø´Ø±Ù Ù…Ù† Ø¯Ø¹Ù… Ø§Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©."},

  {title:"ØªÙˆØ²ÙŠØ¹ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ 2025Ù…", kind:"Ù„Ø§Ø¦Ø­Ø©",
   url:"https://drive.google.com/file/d/1aJfnmDnFuvE5STTsZ6PIGeMJLfYG0Xcl/view?usp=sharing",
   desc:"Ø¢Ù„ÙŠØ© Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ£Ø¹Ù…Ø§Ù„ Ø§Ù„ÙØµÙ„."},

  {title:"Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªØ·ÙˆØ¹ÙŠ", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1MBrdcVABkZajfh97JS1Csv7juRwuvsM9/view?usp=sharing",
   desc:"ØªÙ†Ø¸ÙŠÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ø§Ù„ØªØ·ÙˆØ¹ ÙˆØ¯Ø¹Ù… Ø±Ø¤ÙŠØ© 2030."},

  {title:"Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª 2025Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1igqY7tNeqoEPX7YV6VqTw0GnGUWDzBNf/view?usp=sharing",
   desc:"Ø§Ù„Ø£Ø³Ø³ Ø§Ù„ÙÙ†ÙŠØ© ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª."},

  {title:"Ø¯Ù„ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ 2025Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1XAMG04koxiH2pd8jfVwgFTYKvGX_JqHf/view?usp=sharing",
   desc:"Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‹Ø§."},

  {title:"Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø²ÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ ÙˆØ§Ù„Ø±ÙŠØ§Ø¶ÙŠ Ù„Ø·Ù„Ø¨Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù…", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1dJaj5cH6sUOpUh2shay36xH7FctVxZXh/view?usp=sharing",
   desc:"Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ù„Ù„Ø²ÙŠ Ø¨Ù…Ø§ ÙŠØ¹Ø²Ø² Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·."},

  {title:"Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ù‡Ù†ÙŠ Ù„Ù…ÙˆØ¸ÙÙŠ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… 2025", kind:"Ø¯Ù„ÙŠÙ„",
   url:"https://drive.google.com/file/d/1FP2_l_4vTqbuBK7k03YktLX92TVdqDcy/view?usp=sharing",
   desc:"Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù…Ù‡Ù†ÙŠØ© Ù„Ù…Ù†Ø³ÙˆØ¨ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ…."},

  {title:"Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„ÙÙ†ÙŠ Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©", kind:"Ù†Ù…ÙˆØ°Ø¬",
   url:"https://drive.google.com/file/d/1Q2SnbnnteJCIgyz8WZCESV01Jk_3rPMh/view?usp=sharing",
   desc:"Ù†Ù…ÙˆØ°Ø¬ ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø²ÙŠØ§Ø±Ø©: Ù…Ø¹Ø§ÙŠÙŠØ±ØŒ Ù…Ø¤Ø´Ø±Ø§ØªØŒ ÙˆØªÙˆØµÙŠØ§Øª."}
];

/* ===== Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª ===== */
const INITIATIVES_DEFAULT = [
  {title:"Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø¯Ø¹Ù… ÙˆØªØ·ÙˆÙŠØ± Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©", url:"https://fhz545-hub.github.io/teachervisit/", note:"ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„ØµÙÙ‘ÙŠØ© ÙˆÙ†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ†."},
  {title:"Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©", url:"https://fhz545-hub.github.io/teacher-eval-1447/", note:"Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø· ÙˆØ§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥Ø´Ø±Ø§ÙÙŠØ©."},
  {title:"Ù†Ù…ÙˆØ°Ø¬ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ", url:"https://fhz545-hub.github.io/taqyeem/", note:"Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†ØµÙÙŠØ© ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ."},
  {title:"Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù„Ø­Ø¸ÙŠ", url:"https://fhz545-hub.github.io/jadwal-live/", note:"Ø¬Ø¯Ø§ÙˆÙ„ ÙˆÙ…ÙˆØ§Ø¹ÙŠØ¯ ÙˆØªÙƒÙ„ÙŠÙØ§Øª Ù„Ø­Ø¸ÙŠØ©."},
  {title:"Ù†Ù…ÙˆØ°Ø¬ ØªØµÙ…ÙŠÙ… ÙˆØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬/Ù†Ø´Ø§Ø·", url:"https://fhz545-hub.github.io/Report/", note:"Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚ Ø¨Ø§Ù„Ø£Ø«Ø±."}
];

/* ============ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ ============ */
let PLATFORMS = JSON.parse(localStorage.getItem(KEY_PLAT) || 'null') || PLATFORMS_DEFAULT;
let DOCS = JSON.parse(localStorage.getItem(KEY_DOCS) || 'null') || DOCS_DEFAULT;
let INITIATIVES = JSON.parse(localStorage.getItem(KEY_INIT) || 'null') || INITIATIVES_DEFAULT;

/* ============ ØªÙˆÙ„ÙŠØ¯ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù†ØµØ§Øª ============ */
const grid = document.getElementById('platformGrid');
const countP = document.getElementById('countP');
const search = document.getElementById('platformSearch');
const filterChips = [...document.querySelectorAll('.chip')];

function renderPlatforms(){
  const q=(search.value||"").trim().toLowerCase();
  const active=filterChips.find(c=>c.classList.contains('active'))?.dataset.filter||'all';
  grid.innerHTML=''; let shown=0;
  PLATFORMS.forEach(p=>{
    const okFilter=(active==='all')||(p.tags||[]).includes(active);
    const okSearch=!q||p.name.toLowerCase().includes(q)||(p.desc||'').toLowerCase().includes(q);
    if(okFilter && okSearch){
      shown++;
      grid.insertAdjacentHTML('beforeend',`
        <a class="card linkcard" href="${p.url}" target="_blank" rel="noopener" data-tags="${(p.tags||[]).join(',')}">
          <div class="title">${p.name}</div>
          <div class="desc">${p.desc||''}</div>
          <div class="badges">${(p.tags||[]).map(t=>`<span class="badge">${t}</span>`).join('')}</div>
        </a>
      `);
    }
  });
  countP.textContent="";
}
filterChips.forEach(c=>c.addEventListener('click',()=>{filterChips.forEach(x=>x.classList.remove('active'));c.classList.add('active');renderPlatforms();}));
search.addEventListener('input',renderPlatforms);
renderPlatforms();

/* ============ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª ============ */
const initList=document.getElementById('initList');
function renderInitiatives(){
  initList.innerHTML='';
  INITIATIVES.forEach(it=>{
    initList.insertAdjacentHTML('beforeend',`
      <a class="card linkcard" href="${it.url}" target="_blank" rel="noopener">
        <div class="title">${it.title}</div>
        <div class="desc">${it.note||''}</div>
      </a>
    `);
  });
}
renderInitiatives();

/* ============ Ø§Ù„Ø£Ø¯Ù„Ù‘Ø©: Ø¹Ø±Ø¶ + ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± ============ */
const docsCols=document.getElementById('docsCols');
function linkFor(d){return d.fileDataUrl?d.fileDataUrl:(d.url||"#");}
function driveDirectDownload(u){try{const m=u.match(/drive\.google\.com\/file\/d\/([^/]+)\//i);return(m&&m[1])?`https://drive.google.com/uc?export=download&id=${m[1]}`:u;}catch{return u;}}
function safeName(t){return (t||'document').replace(/[\\/:*?"<>|]+/g,' ').trim()+'.pdf';}

function renderDocs(){
  docsCols.innerHTML='';
  const colA=document.createElement('div');
  const colB=document.createElement('div');
  const colC=document.createElement('div');
  DOCS.forEach((d,i)=>{
    const openHref=linkFor(d);
    const dlHref=d.fileDataUrl?d.fileDataUrl:driveDirectDownload(d.url||'#');
    const card=`
      <article class="card" style="grid-template-columns:1fr auto">
        <div>
          <div class="title">${d.title}</div>
          <div class="desc">${d.desc||''}</div>
          <div class="badges"><span class="badge">${d.kind||"Ø¯Ù„ÙŠÙ„"}</span></div>
        </div>
        <div class="actions">
          <a class="btn open" href="${openHref}" target="_blank" rel="noopener" title="ÙØªØ­ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯">
            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M14 3h7v7h-2V6.41l-9.29 9.3l-1.42-1.42l9.3-9.29H14V3ZM5 5h7v2H7v10h10v-5h2v7H5V5Z"/></svg>
            ÙØªØ­
          </a>
          <a class="btn download" href="${dlHref}" download="${safeName(d.title)}" title="ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù">
            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 3a1 1 0 0 1 1 1v8.586l2.293-2.293l1.414 1.414L12 16.414l-4.707-4.707l1.414-1.414L11 12.586V4a1 1 0 0 1 1-1ZM5 20a1 1 0 0 1-1-1v-2h2v1h12v-1h2v2a1 1 0 0 1-1 1H5Z"/></svg>
            ØªØ­Ù…ÙŠÙ„
          </a>
        </div>
      </article>`;
    if(i%3===0) colA.insertAdjacentHTML('beforeend',card);
    else if(i%3===1) colB.insertAdjacentHTML('beforeend',card);
    else colC.insertAdjacentHTML('beforeend',card);
  });
  docsCols.appendChild(colA);docsCols.appendChild(colB);docsCols.appendChild(colC);
}
renderDocs();

/* ============ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯Ù„Ù‘Ø© (PIN Ù¡Ù¤Ù¤Ù§) ============ */
const Mback=document.getElementById('docsModalBack');
const btnManage=document.getElementById('btnManageDocs');
const listAdmin=document.getElementById('docsListAdmin');
const fTitle=document.getElementById('docTitle');
const fKind=document.getElementById('docKind');
const fUrl=document.getElementById('docUrl');
const fFile=document.getElementById('docFile');
const fDesc=document.getElementById('docDesc');
const btnAdd=document.getElementById('addDoc');
const btnSave=document.getElementById('saveDoc');
const btnCancel=document.getElementById('cancelDoc');
const btnReset=document.getElementById('resetDocs');
let editIndex=-1;

function adminList(){
  listAdmin.innerHTML=DOCS.map((d,i)=>`
    <div class="card" style="grid-template-columns:1fr auto;align-items:center">
      <div>
        <div class="title">${d.title}</div>
        <div class="desc" style="margin-top:3px">${d.desc||''}</div>
        <div class="badges" style="margin-top:6px">
          <span class="badge">${d.kind||"Ø¯Ù„ÙŠÙ„"}</span>
          ${d.fileDataUrl?`<span class="badge">PDF Ù…Ø­Ù„ÙŠ</span>`:''}
          ${d.url?`<span class="badge">Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ</span>`:''}
        </div>
      </div>
      <div class="actions">
        <button class="btn" onclick="editDoc(${i})">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn" onclick="delDoc(${i})">Ø­Ø°Ù</button>
      </div>
    </div>`).join('');
}
function openDocsModal(){
  const ok=sessionStorage.getItem('docs_admin_ok')==='1'||prompt('Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (PIN)')===ADMIN_PIN;
  if(!ok) return;
  sessionStorage.setItem('docs_admin_ok','1');
  adminList();
  fTitle.value=fKind.value=fUrl.value=fDesc.value=''; fFile.value=''; editIndex=-1;
  Mback.style.display='grid';
}
function closeDocsModal(){Mback.style.display='none';}
btnManage.addEventListener('click',openDocsModal);
btnCancel.addEventListener('click',closeDocsModal);
btnAdd.addEventListener('click',()=>{editIndex=-1;fTitle.value='';fKind.value='Ø¯Ù„ÙŠÙ„';fUrl.value='';fFile.value='';fDesc.value='';});
btnSave.addEventListener('click',async()=>{
  const item={title:fTitle.value.trim(),kind:fKind.value,url:fUrl.value.trim(),desc:fDesc.value.trim()};
  if(!item.title){alert('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨');return;}
  if(fFile.files&&fFile.files[0]){
    const file=fFile.files[0];
    if(file.type!=='application/pdf'){alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ PDF ÙÙ‚Ø·');return;}
    item.fileDataUrl=await fileToDataUrl(file);
  }
  if(editIndex>=0){DOCS[editIndex]={...DOCS[editIndex],...item};}
  else{DOCS.push(item);}
  localStorage.setItem(KEY_DOCS,JSON.stringify(DOCS));
  renderDocs();adminList();
  fTitle.value=fKind.value=fUrl.value=fDesc.value='';fFile.value='';
});
btnReset.addEventListener('click',()=>{
  if(confirm('ØªØ£ÙƒÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„Ø£Ø¯Ù„Ù‘Ø©ØŸ')){localStorage.removeItem(KEY_DOCS);DOCS=[...DOCS_DEFAULT];renderDocs();adminList();}
});
window.editDoc=(i)=>{editIndex=i;const d=DOCS[i];fTitle.value=d.title||'';fKind.value=d.kind||'Ø¯Ù„ÙŠÙ„';fUrl.value=d.url||'';fDesc.value=d.desc||'';fFile.value='';document.querySelector('#docsModalBack .body').scrollTop=0;}
window.delDoc=(i)=>{if(!confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ØŸ'))return;DOCS.splice(i,1);localStorage.setItem(KEY_DOCS,JSON.stringify(DOCS));renderDocs();adminList();}
function fileToDataUrl(file){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result);r.onerror=rej;r.readAsDataURL(file);});}

/* ============ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ§Øª (PIN) ============ */
const Pback=document.getElementById('platModalBack');
const btnPlat=document.getElementById('btnEditPlatforms');
const txtPlat=document.getElementById('platEditor');
const btnSavePlat=document.getElementById('savePlat');
const btnResetPlat=document.getElementById('resetPlat');
const btnCancelPlat=document.getElementById('cancelPlat');

function openPlatModal(){
  const ok=sessionStorage.getItem('plat_admin_ok')==='1'||prompt('Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (PIN)')===ADMIN_PIN;
  if(!ok)return;
  sessionStorage.setItem('plat_admin_ok','1');
  txtPlat.value=JSON.stringify(PLATFORMS,null,2);
  Pback.style.display='grid';
}
btnPlat.addEventListener('click',openPlatModal);
btnCancelPlat.addEventListener('click',()=>Pback.style.display='none');
btnResetPlat.addEventListener('click',()=>{
  if(confirm('Ø¥Ø±Ø¬Ø§Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØµØ§Øª Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØŸ')){
    PLATFORMS=[...PLATFORMS_DEFAULT];
    localStorage.removeItem(KEY_PLAT);
    renderPlatforms();
    txtPlat.value=JSON.stringify(PLATFORMS,null,2);
  }
});
btnSavePlat.addEventListener('click',()=>{
  try{
    const parsed=JSON.parse(txtPlat.value);
    if(!Array.isArray(parsed)) throw new Error('ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…ØµÙÙˆÙØ© Ø¹Ù†Ø§ØµØ±');
    PLATFORMS=parsed; localStorage.setItem(KEY_PLAT,JSON.stringify(PLATFORMS));
    renderPlatforms(); Pback.style.display='none';
  }catch(e){alert('JSON ØºÙŠØ± ØµØ§Ù„Ø­:\\n'+e.message);}
});

/* ============ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª (PIN) ============ */
const Iback=document.getElementById('initModalBack');
const btnInit=document.getElementById('btnEditInit');
const txtInit=document.getElementById('initEditor');
const btnSaveInit=document.getElementById('saveInit');
const btnResetInit=document.getElementById('resetInit');
const btnCancelInit=document.getElementById('cancelInit');

function openInitModal(){
  const ok=sessionStorage.getItem('init_admin_ok')==='1'||prompt('Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (PIN)')===ADMIN_PIN;
  if(!ok)return;
  sessionStorage.setItem('init_admin_ok','1');
  txtInit.value=JSON.stringify(INITIATIVES,null,2);
  Iback.style.display='grid';
}
btnInit.addEventListener('click',openInitModal);
btnCancelInit.addEventListener('click',()=>Iback.style.display='none');
btnResetInit.addEventListener('click',()=>{
  if(confirm('Ø¥Ø±Ø¬Ø§Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØŸ')){
    INITIATIVES=[...INITIATIVES_DEFAULT]; localStorage.removeItem(KEY_INIT);
    renderInitiatives(); txtInit.value=JSON.stringify(INITIATIVES,null,2);
  }
});
btnSaveInit.addEventListener('click',()=>{
  try{
    const parsed=JSON.parse(txtInit.value);
    if(!Array.isArray(parsed)) throw new Error('ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…ØµÙÙˆÙØ© Ø¹Ù†Ø§ØµØ±');
    parsed.forEach((it,i)=>{if(!it.title||!it.url) throw new Error(`Ø¹Ù†ØµØ± #${i+1}: title Ùˆ url Ù…Ø·Ù„ÙˆØ¨Ø©`);});
    INITIATIVES=parsed; localStorage.setItem(KEY_INIT,JSON.stringify(INITIATIVES));
    renderInitiatives(); Iback.style.display='none';
  }catch(e){alert('JSON ØºÙŠØ± ØµØ§Ù„Ø­:\\n'+e.message);}
});

/* Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª */
document.querySelectorAll('.modal-back').forEach(back=>{
  back.addEventListener('click',(e)=>{if(e.target===back) back.style.display='none';});
});
document.addEventListener('keydown',(e)=>{if(e.key==='Escape'){document.querySelectorAll('.modal-back').forEach(back=>back.style.display='none');}});
</script>
</body>
</html>
